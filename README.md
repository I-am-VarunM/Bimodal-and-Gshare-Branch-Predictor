# Branch Predictor Simulator

A configurable branch predictor simulator developed for CS6600 (July-Nov '24) at IIT Madras that implements both bimodal and gshare prediction schemes. The simulator analyzes prediction accuracy across different configurations using SPECint95 benchmark traces.

## Project Overview

This simulator implements two types of branch predictors:
- Bimodal Predictor: Uses only PC bits for prediction
- Gshare Predictor: Combines PC bits with global branch history

### Key Features

- Configurable predictor parameters:
  - m: Number of PC bits used for indexing (7-12)
  - n: Number of global history bits (0-m)
- 2-bit saturating counters
- Performance metrics calculation
- Visualization tools for analysis

## Project Structure

```
branch-predictor/
├── Source Files
│   ├── branch_predictor.cpp    # Main implementation
│   ├── branch_predictor.o      # Object file
│   ├── bimodal.h              # Bimodal predictor header
│   └── gshare.h               # Gshare predictor header
├── Analysis Tools
│   ├── plot.py                # Bimodal analysis plotting
│   └── plotgshare.py          # Gshare analysis plotting
├── Trace Files
│   ├── gcc_trace.txt          # GCC benchmark trace
│   └── jpeg_trace.txt         # JPEG benchmark trace
├── Output Files               # Generated by analysis scripts
│   ├── gcc_m*_*.out          # GCC outputs for different m,n
│   └── jpeg_m*_*.out         # JPEG outputs for different m,n
├── Plots
│   ├── gcc_bimodal_predictor_plot.png
│   ├── gcc_gshare_predictor_plot.png
│   ├── jpeg_bimodal_predictor_plot.png
│   └── jpeg_gshare_predictor_plot.png
└── Build Files
    ├── Makefile
    └── Dockerfile
```

## Building and Running

### Using Docker (Recommended)

1. Build Docker image:
   ```bash
   docker build -t assign2 .
   ```

2. Run container:
   ```bash
   docker run -it assign2 /bin/bash
   cd Assignment_files
   make
   ```

### Running the Simulator

1. For Bimodal predictor:
   ```bash
   ./bpsim bimodal <M> <trace_file>
   ```
   Example: `./bpsim bimodal 7 gcc_trace.txt`

2. For Gshare predictor:
   ```bash
   ./bpsim gshare <M> <N> <trace_file>
   ```
   Example: `./bpsim gshare 12 4 gcc_trace.txt`

Parameters:
- M: Number of PC bits (7-12)
- N: Number of global history bits (2-M, even numbers)
- trace_file: Input trace file path

## Analysis and Plotting

1. Bimodal Analysis:
   ```bash
   python3 plot.py
   ```
   Generates plots for m=7 to 12

2. Gshare Analysis:
   ```bash
   python3 plotgshare.py
   ```
   Generates plots for different combinations of m and n

Output files (gcc_m*_*.out, jpeg_m*_*.out) contain:
- Number of branches
- Number of mispredictions
- Misprediction rate

## Experiments

The project analyzes:
1. Bimodal Predictor (m: 7-12):
   - Impact of PC bits on prediction accuracy
   - Storage efficiency analysis

2. Gshare Predictor (m: 7-12, n: 2-m):
   - Combined effect of PC bits and history
   - Performance vs storage tradeoffs
   - Comparison with bimodal predictor

## Validation

Compare simulator output with reference:
```bash
./bpsim <params> > output.txt
diff -iw output.txt validation/reference.txt
```

## License

This project is part of the CS6600 course at IIT Madras. All rights reserved.
